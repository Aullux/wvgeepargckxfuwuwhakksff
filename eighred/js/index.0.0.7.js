!function(){"use strict";const e={bizName:"",reportOrigin:"",isInner:!1,userId:"",staticResourceWhiteList:[],sendPV:!1,enableSPA:!1,sendResourceError:!0,sendError:!1,sendPerf:!0,interfaceDurationLimit:2e3,sendBlankScreenError:!1,dirtyThreshold:6e4,lang:""};var n=(e=>(e.stability="stability",e.performance="performance",e.behavior="behavior",e.customize="customize",e))(n||{}),t=(e=>(e.FirstPaint="FP",e.FirstMeaningfulPaint="FMP",e.TimeToTnteractive="TTI",e.Load="LOAD",e.DomContentLoaded="DCL",e.FirstContentfulPaint="FCP",e.TimeToFirstByte="TTFB",e.LargestContentfulPaint="LCP",e.FirstInputDelay="FID",e.CumulativeLayoutShift="CLS",e.APIDuration="APIDuration",e.ImgDuration="ImgDuration",e))(t||{}),r=(e=>(e.PV="PV",e.ButtonClick="ButtonClick",e))(r||{}),i=Object.defineProperty,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,n,t)=>n in e?i(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const s="undefined"!=typeof fetch&&void 0!==navigator.sendBeacon,l=window.location.host.includes("localhost")||window.location.host.includes("dev.local")||window.location.host.includes("local:8443"),d="undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process);function f(e,n="POST",t){return new Promise(((r,i)=>{let s={};"GET"!==n&&(s={headers:{"Content-Type":"application/json"},body:t}),fetch(e,((e,n)=>{for(var t in n||(n={}))a.call(n,t)&&u(e,t,n[t]);if(o)for(var t of o(n))c.call(n,t)&&u(e,t,n[t]);return e})({mode:"cors",method:n},s)).then((e=>e.json())).then((e=>{r(e)})).catch((e=>{i(e)}))}))}let p=[];function v(){return JSON.parse(JSON.stringify(p))}function m(){p.length=0,p=[]}var g=Object.defineProperty,y=Object.defineProperties,h=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,E=(e,n,t)=>n in e?g(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,P=(e,n)=>{for(var t in n||(n={}))b.call(n,t)&&E(e,t,n[t]);if(w)for(var t of w(n))T.call(n,t)&&E(e,t,n[t]);return e};function L(t){try{let r="";e.reportOrigin?r=e.reportOrigin:e.isInner&&(r="https://apm.okg.com");const i=`${r}/umd/web/metric/v1`,o=t.map((t=>{if(t.kind===n.performance){const n=Number(t.value);return!l&&n>0&&n<=e.dirtyThreshold?t:""}return t})).filter(Boolean);if(!(null==o?void 0:o.length))return;const a=JSON.stringify(o);if(void 0!==navigator.sendBeacon&&e.isInner)try{const e=new Blob([a],{type:"application/json"});window.navigator.sendBeacon(i,e)}catch(e){console.error("perf sendBeacon  error",e)}else"undefined"!=typeof fetch&&f(i,"post",a)}catch(e){console.error("perf sendLogRequest error",e)}}function O(n){var t;let r;const i=function(){var n,t;const{location:r,document:i}=window,{href:o,host:a}=r,{referrer:c}=i,u=window._okGlobal||window.okGlobal||{};return{biz:e.bizName,time:Date.now(),urlPath:o,host:a,referrer:c,sdkVersion:"0.0.7",lang:(null==u?void 0:u.locale)||(null==(n=e)?void 0:n.lang)||"default",station:(null==(t=null==u?void 0:u.site)?void 0:t.sign)||e.bizName}}();return r=Array.isArray(n)?n.map((e=>P(P({},i),e))):[P(P({},i),n)],(null==(t=e)?void 0:t.userId)&&(r=r.map((n=>{var t;const r=Object.assign((null==n?void 0:n.attributes)||{},{userKey:null==(t=e)?void 0:t.userId});return((e,n)=>y(e,h(n)))(P({},n),{attributes:r})}))),r}function S(e,n){try{let t={};t=n?e:O(e),L(t)}catch(e){console.error("perf sendLog error",e)}}let k=null;function C(e,n=3e3){!function(e){p=(v()||[]).concat(e)}(O(e)),clearTimeout(k);const t=v();(null==t?void 0:t.length)>=50?(S(t),m()):k=setTimeout((()=>{(null==t?void 0:t.length)&&(S(t),m())}),n)}var j,D,F,A,I=-1,B=function(e){addEventListener("pageshow",(function(n){n.persisted&&(I=n.timeStamp,e(n))}),!0)},z=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},N=function(){var e=z();return e&&e.activationStart||0},q=function(e,n){var t=z(),r="navigate";return I>=0?r="back-forward-cache":t&&(r=document.prerendering||N()>0?"prerender":t.type.replace(/_/g,"-")),{name:e,value:void 0===n?-1:n,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},x=function(e,n,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){n(e.getEntries())}));return r.observe(Object.assign({type:e,buffered:!0},t||{})),r}}catch(e){}},R=function(e,n){var t=function t(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),n&&(removeEventListener("visibilitychange",t,!0),removeEventListener("pagehide",t,!0)))};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},M=function(e,n,t,r){var i,o;return function(a){n.value>=0&&(a||r)&&((o=n.value-(i||0))||void 0===i)&&(i=n.value,n.delta=o,n.rating=function(e,n){return e>n[1]?"poor":e>n[0]?"needs-improvement":"good"}(n.value,t),e(n))}},G=-1,K=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},V=function(){R((function(e){var n=e.timeStamp;G=n}),!0)},_=function(){return G<0&&(G=K(),V(),B((function(){setTimeout((function(){G=K(),V()}),0)}))),{get firstHiddenTime(){return G}}},H=function(e,n){n=n||{};var t,r=[1800,3e3],i=_(),o=q("FCP"),a=function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(u&&u.disconnect(),e.startTime<i.firstHiddenTime&&(o.value=e.startTime-N(),o.entries.push(e),t(!0)))}))},c=window.performance&&window.performance.getEntriesByName&&window.performance.getEntriesByName("first-contentful-paint")[0],u=c?null:x("paint",a);(c||u)&&(t=M(e,o,r,n.reportAllChanges),c&&a([c]),B((function(i){o=q("FCP"),t=M(e,o,r,n.reportAllChanges),requestAnimationFrame((function(){requestAnimationFrame((function(){o.value=performance.now()-i.timeStamp,t(!0)}))}))})))},$=!1,J=-1,W={passive:!0,capture:!0},Q=new Date,U=function(e,n){j||(j=n,D=e,F=new Date,Z(removeEventListener),X())},X=function(){if(D>=0&&D<F-Q){var e={entryType:"first-input",name:j.type,target:j.target,cancelable:j.cancelable,startTime:j.timeStamp,processingStart:j.timeStamp+D};A.forEach((function(n){n(e)})),A=[]}},Y=function(e){if(e.cancelable){var n=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,n){var t=function(){U(e,n),i()},r=function(){i()},i=function(){removeEventListener("pointerup",t,W),removeEventListener("pointercancel",r,W)};addEventListener("pointerup",t,W),addEventListener("pointercancel",r,W)}(n,e):U(n,e)}},Z=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(n){return e(n,Y,W)}))},ee={},ne=function e(n){document.prerendering?addEventListener("prerenderingchange",(function(){return e(n)}),!0):"complete"!==document.readyState?addEventListener("load",(function(){return e(n)}),!0):setTimeout(n,0)},te=function(e,n){n=n||{};var t=[800,1800],r=q("TTFB"),i=M(e,r,t,n.reportAllChanges);ne((function(){var o=z();if(o){if(r.value=Math.max(o.responseStart-N(),0),r.value<0||r.value>performance.now())return;r.entries=[o],i(!0),B((function(){r=q("TTFB",0),(i=M(e,r,t,n.reportAllChanges))(!0)}))}}))};function re(e){const{name:t,value:r}=e;S({kind:n.performance,type:t,value:r})}function ie(){window.PerformanceObserver&&new PerformanceObserver(((e,r)=>{let i;e.getEntries().forEach((e=>{"first-paint"===e.name&&(i={kind:n.performance,type:t.FirstPaint,value:e.startTime})})),C([i]),r.disconnect()})).observe({type:"paint",buffered:!0}),function(e,n){n=n||{};var t=[.1,.25];$||(H((function(e){J=e.value})),$=!0);var r,i=function(n){J>-1&&e(n)},o=q("CLS",0),a=0,c=[],u=function(e){e.forEach((function(e){if(!e.hadRecentInput){var n=c[0],t=c[c.length-1];a&&e.startTime-t.startTime<1e3&&e.startTime-n.startTime<5e3?(a+=e.value,c.push(e)):(a=e.value,c=[e]),a>o.value&&(o.value=a,o.entries=c,r())}}))},s=x("layout-shift",u);s&&(r=M(i,o,t,n.reportAllChanges),R((function(){u(s.takeRecords()),r(!0)})),B((function(){a=0,J=-1,o=q("CLS",0),r=M(i,o,t,n.reportAllChanges)})))}(re),function(e,n){n=n||{};var t,r=[100,300],i=_(),o=q("FID"),a=function(e){e.startTime<i.firstHiddenTime&&(o.value=e.processingStart-e.startTime,o.entries.push(e),t(!0))},c=function(e){e.forEach(a)},u=x("first-input",c);t=M(e,o,r,n.reportAllChanges),u&&R((function(){c(u.takeRecords()),u.disconnect()}),!0),u&&B((function(){var i;o=q("FID"),t=M(e,o,r,n.reportAllChanges),A=[],D=-1,j=null,Z(addEventListener),i=a,A.push(i),X()}))}(re),function(e,n){n=n||{};var t,r=[2500,4e3],i=_(),o=q("LCP"),a=function(e){var n=e[e.length-1];if(n){var r=n.startTime-N();r<i.firstHiddenTime&&(o.value=r,o.entries=[n],t())}},c=x("largest-contentful-paint",a);if(c){t=M(e,o,r,n.reportAllChanges);var u=function(){ee[o.id]||(a(c.takeRecords()),c.disconnect(),ee[o.id]=!0,t(!0))};["keydown","click"].forEach((function(e){addEventListener(e,u,{once:!0,capture:!0})})),R(u,!0),B((function(i){o=q("LCP"),t=M(e,o,r,n.reportAllChanges),requestAnimationFrame((function(){requestAnimationFrame((function(){o.value=performance.now()-i.timeStamp,ee[o.id]=!0,t(!0)}))}))}))}}(re),te(re),H(re),function(){var r;((null==window?void 0:window.performance)||(null==(r=null==window?void 0:window.performance)?void 0:r.getEntries))&&new PerformanceObserver(((r,i)=>{const o=r.getEntries();let a=[];o.forEach((r=>{var i;(null==r?void 0:r.transferSize)&&("xmlhttprequest"!==r.initiatorType&&"fetch"!==r.initiatorType||r.name&&!r.name.includes("/umd/web/metric/v1")&&r.duration>=((null==(i=e)?void 0:i.interfaceDurationLimit)||0)&&a.push({kind:n.performance,type:t.APIDuration,value:r.duration,attributes:{extranKey:r.name,extra1Key:r.encodedBodySize||0}}),"img"!==r.initiatorType&&"image"!==r.initiatorType||!r.duration||r.name&&a.push({kind:n.performance,type:t.ImgDuration,value:r.duration,attributes:{extranKey:r.name,extra1Key:r.encodedBodySize||0}}))})),(null==a?void 0:a.length)&&C(a)})).observe({entryTypes:["resource"],buffered:!0})}()}function oe(){S({kind:n.behavior,type:r.PV,value:1})}function ae(){"visible"===document.visibilityState&&oe()}var ce=Object.defineProperty,ue=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,de=(e,n,t)=>n in e?ce(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;class fe{constructor(n){if(!n.bizName)throw new Error("perf sdk bizName is required");!function(n){for(const t in e)n[t]&&(e[t]=n[t])}(n),this.init()}init(){try{if(!s)return;if(d)return{fmp:()=>{},customLog:()=>{},buttonClick:()=>{}};window.addEventListener("load",(()=>{"visible"===document.visibilityState?oe():document.addEventListener("visibilitychange",(()=>{ae()}))})),window.addEventListener("popstate",ae),window.addEventListener("pushState",ae),window.addEventListener("replaceState",ae),window.addEventListener("hashchange",ae),ie()}catch(e){console.error(`init perf sdk fail, error ${e}`)}}fmp(){const e=Date.now()-window.performance.timing.navigationStart;S({kind:n.performance,type:t.FirstMeaningfulPaint,value:e})}buttonClick(){S({kind:n.behavior,type:r.ButtonClick,value:1})}customLog(e){S(Object.assign(((e,n)=>{for(var t in n||(n={}))se.call(n,t)&&de(e,t,n[t]);if(ue)for(var t of ue(n))le.call(n,t)&&de(e,t,n[t]);return e})({kind:n.customize},e)))}log(e){var n;n=e,console.log(n)}}try{!function(){var e,n;if(d||l)return;const t=window._okGlobal||window.okGlobal||{},r=null==(e=null==window?void 0:window.location)?void 0:e.hostname,i=(null==(n=null==t?void 0:t.site)?void 0:n.sign)||r,o=r.includes("beta.okex.org")?"beta__":"";i&&(window.OkPerf=new fe({bizName:`${o}${i}`}))}()}catch(j){console.error("init perf sdk fail, error: ",j)}}();